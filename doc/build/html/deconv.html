<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Deconvolution &mdash; AIPY v1.0.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="AIPY v1.0.1 documentation" href="index.html" />
    <link rel="next" title="Full Sky Mapping" href="map.html" />
    <link rel="prev" title="Gridding and Imaging" href="img.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="map.html" title="Full Sky Mapping"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="img.html" title="Gridding and Imaging"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">AIPY v1.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-aipy.deconv">
<h1>Deconvolution<a class="headerlink" href="#module-aipy.deconv" title="Permalink to this headline">¶</a></h1>
<p>A module implementing various techniques for deconvolving an image by a
kernel.  Currently implemented are Clean, Least-Squares, Maximum Entropy,
and Annealing.  Standard parameters to these functions are:
im = image to be deconvolved.
ker = kernel to deconvolve by (must be same size as im).
mdl = a priori model of what the deconvolved image should look like.
maxiter = maximum number of iterations performed before terminating.
tol = termination criterion, lower being more optimized.
verbose =  print info on how things are progressing.
lower = lower bound of pixel values in deconvolved image
upper = upper bound of pixel values in deconvolved image</p>
<dl class="function">
<dt id="aipy.deconv.anneal">
<tt class="descclassname">aipy.deconv.</tt><tt class="descname">anneal</tt><big>(</big><em>im</em>, <em>ker</em>, <em>mdl=None</em>, <em>maxiter=1000</em>, <em>lower=2.2250738585072014e-308</em>, <em>upper=inf</em>, <em>cooling=&lt;function &lt;lambda&gt; at 0x2532668&gt;</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#aipy.deconv.anneal" title="Permalink to this definition">¶</a></dt>
<dd><p>Annealing takes a non-deterministic approach to deconvolution by
randomly perturbing the model and selecting perturbations that improve the 
residual.  By slowly reducing the temperature of the perturbations, 
annealing attempts to settle into a global minimum.  Annealing is slower
than lsq for a known gradient, but is less sensitive to gradient errors 
(it can solve for wider kernels). Faster cooling speeds terminate more 
quickly, but are less likely to find the global minimum.  This 
implementation assigns a temperature to each pixel proportional to the 
magnitude of the residual in that pixel and the global cooling speed.
cooling: A function accepting (iteration,residuals) that returns a</p>
<blockquote>
vector of standard deviation for noise in the respective pixels.
Picking the scaling of this function correctly is vital for annealing
to work.</blockquote>
</dd></dl>

<dl class="function">
<dt id="aipy.deconv.clean">
<tt class="descclassname">aipy.deconv.</tt><tt class="descname">clean</tt><big>(</big><em>im</em>, <em>ker</em>, <em>mdl=None</em>, <em>gain=0.10000000000000001</em>, <em>maxiter=10000</em>, <em>tol=0.001</em>, <em>stop_if_div=True</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#aipy.deconv.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>This standard Hoegbom clean deconvolution algorithm operates on the 
assumption that the image is composed of point sources.  This makes it a 
poor choice for images with distributed flux.  In each iteration, a point 
is added to the model at the location of the maximum residual, with a 
fraction (specified by &#8216;gain&#8217;) of the magnitude.  The convolution of that 
point is removed from the residual, and the process repeats.  Termination 
happens after &#8216;maxiter&#8217; iterations, or when the clean loops starts 
increasing the magnitude of the residual.  This implementation can handle 
1 and 2 dimensional data that is real valued or complex.
gain: The fraction of a residual used in each iteration.  If this is too</p>
<blockquote>
low, clean takes unnecessarily long.  If it is too high, clean does
a poor job of deconvolving.</blockquote>
</dd></dl>

<dl class="function">
<dt id="aipy.deconv.lsq">
<tt class="descclassname">aipy.deconv.</tt><tt class="descname">lsq</tt><big>(</big><em>im</em>, <em>ker</em>, <em>mdl=None</em>, <em>gain=0.10000000000000001</em>, <em>tol=0.001</em>, <em>maxiter=200</em>, <em>lower=2.2250738585072014e-308</em>, <em>upper=inf</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#aipy.deconv.lsq" title="Permalink to this definition">¶</a></dt>
<dd><p>This simple least-square fitting procedure for deconvolving an image 
saves computing by assuming a diagonal pixel-pixel gradient of the fit.
In essence, this assumes that the convolution kernel is a delta-function.
This works for small kernels, but not so well for large ones.  See Cornwell 
and Evans, 1984 &#8220;A Simple Maximum Entropy Deconvolution Algorithm&#8221; for more 
information about this approximation.  Unlike maximum entropy, lsq makes 
no promises about maximizing smoothness, but needs no information
about noise levels.  Structure can be introduced for which there is no 
evidence in the original image.  Termination happens when the fractional 
score change is less than &#8216;tol&#8217; between iterations.
gain: The fraction of the step size (calculated from the gradient) taken</p>
<blockquote>
in each iteration.  If this is too low, the fit takes unnecessarily 
long.  If it is too high, the fit process can oscillate.</blockquote>
</dd></dl>

<dl class="function">
<dt id="aipy.deconv.maxent">
<tt class="descclassname">aipy.deconv.</tt><tt class="descname">maxent</tt><big>(</big><em>im</em>, <em>ker</em>, <em>var0</em>, <em>mdl=None</em>, <em>gain=0.10000000000000001</em>, <em>tol=0.001</em>, <em>maxiter=200</em>, <em>lower=2.2250738585072014e-308</em>, <em>upper=inf</em>, <em>verbose=False</em><big>)</big><a class="headerlink" href="#aipy.deconv.maxent" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum entropy deconvolution (MEM) (see Cornwell and Evans 1984
&#8220;A Simple Maximum Entropy Deconvolution Algorithm&#8221; and Sault 1990
&#8220;A Modification of the Cornwell and Evans Maximum Entropy Algorithm&#8221;)
is similar to lsq, but the fit is only optimized to within the specified
variance (var0) and then &#8220;smoothness&#8221; is maximized.  This has several 
desirable effects including uniqueness of solution, equal weighting of
Fourier components, and absence of spurious structure.  The same 
delta-kernel approximation (see lsq) is made here.
var0: The estimated variance (noise power) in the image.  If none is</p>
<blockquote>
provided, a quick lsq is used to estimate the variance of the residual.</blockquote>
<dl class="docutils">
<dt>gain: The fraction of the step size (calculated from the gradient) taken</dt>
<dd>in each iteration.  If this is too low, the fit takes unnecessarily 
long.  If it is too high, the fit process can oscillate.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aipy.deconv.maxent_findvar">
<tt class="descclassname">aipy.deconv.</tt><tt class="descname">maxent_findvar</tt><big>(</big><em>im</em>, <em>ker</em>, <em>var=None</em>, <em>f_var0=0.59999999999999998</em>, <em>mdl=None</em>, <em>gain=0.10000000000000001</em>, <em>tol=0.001</em>, <em>maxiter=200</em>, <em>lower=2.2250738585072014e-308</em>, <em>upper=inf</em>, <em>verbose=False</em>, <em>maxiterok=False</em><big>)</big><a class="headerlink" href="#aipy.deconv.maxent_findvar" title="Permalink to this definition">¶</a></dt>
<dd>This frontend to maxent tries to find a variance for which maxent will
converge.  If the starting variance (var) is not specified, it will be
estimated as a fraction (f_var0) of the variance of the residual of a 
lsq deconvolution, and then a search algorithm tests an ever-widening
range around that value.  This function will search until it succeeds.</dd></dl>

<dl class="function">
<dt id="aipy.deconv.recenter">
<tt class="descclassname">aipy.deconv.</tt><tt class="descname">recenter</tt><big>(</big><em>a</em>, <em>c</em><big>)</big><a class="headerlink" href="#aipy.deconv.recenter" title="Permalink to this definition">¶</a></dt>
<dd>Slide the (0,0) point of matrix a to a new location tuple c.</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="img.html"
                                  title="previous chapter">Gridding and Imaging</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="map.html"
                                  title="next chapter">Full Sky Mapping</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/deconv.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="map.html" title="Full Sky Mapping"
             >next</a> |</li>
        <li class="right" >
          <a href="img.html" title="Gridding and Imaging"
             >previous</a> |</li>
        <li><a href="index.html">AIPY v1.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2011, Aaron Parsons.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.6.
    </div>
  </body>
</html>